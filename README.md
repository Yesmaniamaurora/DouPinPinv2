# 豆拼拼-图纸工厂 (Perler Pattern Factory)

这是一个基于 Web 的拼豆图纸生成系统，支持自定义尺寸、降采样算法和色号匹配。

## 颜色匹配算法说明 (Color Matching Algorithm)
本项目在进行颜色匹配时，**没有**使用简单的 RGB 欧氏距离。而是将 RGB 颜色转换为 **CIE LAB 色彩空间**，然后计算两个颜色在 LAB 空间中的色差 (Delta E)。
CIE LAB 色彩空间是基于人类视觉感知设计的，因此使用 Delta E 计算出的最接近颜色，在人类肉眼看来也是最相似的，这对于拼豆这种实体颜色的匹配至关重要。

## 版本日志 (Changelog)

### v2.1.0 (当前版本)
**修改目标**：
1. **智能寻色辅助 (Intelligent Color Seeking)**：
   - 画布联动：点击生成图中的像素点，自动高亮底栏对应色号，并实时高亮图中所有同色区域。
   - 专注模式：选中颜色时，非目标区域透明度降至 30%，并为目标颜色绘制粗黑边框。
   - 多选/锁定：支持同时点亮 2-3 种相近色，方便批量抓豆。
2. **降采样算法升级**：
   - 新增“频率最大化池化 (Dominant Color Pooling)”算法：在网格内提取出现频率最高的颜色，有效避免灰色杂色，保持边缘锐利。
3. **高级背景移除 (Background Removal)**：
   - 引入洪水填充 (Flood Fill) 算法，从边缘识别并剔除背景区域。
   - 支持 0-100 容差调节，背景区域不计入豆子统计清单。
4. **UI/UX 优化**：
   - 增加高级功能模块，将背景处理与寻色辅助整合。
   - 优化图纸渲染性能。

### v2.0.0
**修改目标**：
1. 增加设备指纹锁 (Device Fingerprinting Lock)：用户必须输入激活密钥才能使用。密钥输入后将与当前浏览器的渲染指纹绑定，实现“一机一码”，其他设备无法使用同一个密钥。
2. 全新色彩主题：采用深邃的 `#20243F` 和清新的 `#a3bdb2` 作为主色调。
3. 标题更新为“豆拼拼-图纸工厂”。
4. 系统架构升级为全栈 (Full-Stack)，引入 Express 和 SQLite 用于验证和存储设备指纹。

**测试密钥 (Test Keys)**：
- `VIP-8888`
- `TEST-0000`

**修改的文件和内容**：
- `server.ts`：新增后端服务，提供 `/api/verify` 接口和 SQLite 数据库存储。
- `src/core/fingerprint.ts`：新增浏览器指纹提取算法（Canvas 纹理 + 分辨率）。
- `src/App.tsx`：增加锁屏界面和鉴权逻辑，全面替换新的配色方案。
- `src/index.css`：更新 Tailwind CSS 主题颜色变量。
- `package.json`：更新启动脚本以支持全栈运行。

### v1.1.0
**修改目标**：
1. 在生成的图片下方增加色号使用统计（包含颜色方块和数量，横向排列）。
2. 增加适量的页边距，使图纸排版更美观。
3. 增加“梯度增强”算法：在区域平均的基础上，增强颜色分界线的对比度，使边缘更锐利。
4. 增加 README 文件，记录详细的版本日志。
5. 增加粗线辅助：每 10 格加粗一条辅助线，10、20、30 等坐标数字放大并加粗。
6. 增加快捷尺寸按钮：18x18（小挂件）、36x36、52x52（标准）、72x72。
7. 增加亮度调节功能（-2 到 +2 档微调）。
8. 界面增加中英文对照。
9. 优化梯度增强算法：弱化边缘增强的程度，并在颜色变化较小（平坦）的区域保持颜色一致性，避免产生噪点。

### v1.0.1
**修改目标**：引入真实的拼豆色卡数据，并支持按品牌色系选择。

### v1.0.0
**修改目标**：初始版本发布。
